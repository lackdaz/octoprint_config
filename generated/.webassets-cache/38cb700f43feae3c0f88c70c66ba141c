V// source: js/lib/ResizeSensor.js\u000a'use strict';\u000a\u000a/**\u000a * Copyright Marc J. Schmidt. See the LICENSE file at the top-level\u000a * directory of this distribution and at\u000a * https://github.com/marcj/css-element-queries/blob/master/LICENSE.\u000a */\u000a(function (root, factory) {\u000a    if (typeof define === "function" && define.amd) {\u000a        define(factory);\u000a    } else if (typeof exports === "object") {\u000a        module.exports = factory();\u000a    } else {\u000a        root.ResizeSensor = factory();\u000a    }\u000a}(typeof window !== 'undefined' ? window : this, function () {\u000a\u000a    // Make sure it does not throw in a SSR (Server Side Rendering) situation\u000a    if (typeof window === "undefined") {\u000a        return null;\u000a    }\u000a    // Only used for the dirty checking, so the event callback count is limited to max 1 call per fps per sensor.\u000a    // In combination with the event based resize sensor this saves cpu time, because the sensor is too fast and\u000a    // would generate too many unnecessary events.\u000a    var requestAnimationFrame = window.requestAnimationFrame ||\u000a        window.mozRequestAnimationFrame ||\u000a        window.webkitRequestAnimationFrame ||\u000a        function (fn) {\u000a            return window.setTimeout(fn, 20);\u000a        };\u000a\u000a    /**\u000a     * Iterate over each of the provided element(s).\u000a     *\u000a     * @param {HTMLElement|HTMLElement[]} elements\u000a     * @param {Function}                  callback\u000a     */\u000a    function forEachElement(elements, callback){\u000a        var elementsType = Object.prototype.toString.call(elements);\u000a        var isCollectionTyped = ('[object Array]' === elementsType\u000a            || ('[object NodeList]' === elementsType)\u000a            || ('[object HTMLCollection]' === elementsType)\u000a            || ('[object Object]' === elementsType)\u000a            || ('undefined' !== typeof jQuery && elements instanceof jQuery) //jquery\u000a            || ('undefined' !== typeof Elements && elements instanceof Elements) //mootools\u000a        );\u000a        var i = 0, j = elements.length;\u000a        if (isCollectionTyped) {\u000a            for (; i < j; i++) {\u000a                callback(elements[i]);\u000a            }\u000a        } else {\u000a            callback(elements);\u000a        }\u000a    }\u000a\u000a    /**\u000a    * Get element size\u000a    * @param {HTMLElement} element\u000a    * @returns {Object} {width, height}\u000a    */\u000a    function getElementSize(element) {\u000a        if (!element.getBoundingClientRect) {\u000a            return {\u000a                width: element.offsetWidth,\u000a                height: element.offsetHeight\u000a            }\u000a        }\u000a\u000a        var rect = element.getBoundingClientRect();\u000a        return {\u000a            width: Math.round(rect.width),\u000a            height: Math.round(rect.height)\u000a        }\u000a    }\u000a\u000a    /**\u000a     * Class for dimension change detection.\u000a     *\u000a     * @param {Element|Element[]|Elements|jQuery} element\u000a     * @param {Function} callback\u000a     *\u000a     * @constructor\u000a     */\u000a    var ResizeSensor = function(element, callback) {\u000a        /**\u000a         *\u000a         * @constructor\u000a         */\u000a        function EventQueue() {\u000a            var q = [];\u000a            this.add = function(ev) {\u000a                q.push(ev);\u000a            };\u000a\u000a            var i, j;\u000a            this.call = function() {\u000a                for (i = 0, j = q.length; i < j; i++) {\u000a                    q[i].call();\u000a                }\u000a            };\u000a\u000a            this.remove = function(ev) {\u000a                var newQueue = [];\u000a                for(i = 0, j = q.length; i < j; i++) {\u000a                    if(q[i] !== ev) newQueue.push(q[i]);\u000a                }\u000a                q = newQueue;\u000a            };\u000a\u000a            this.length = function() {\u000a                return q.length;\u000a            }\u000a        }\u000a\u000a        /**\u000a         *\u000a         * @param {HTMLElement} element\u000a         * @param {Function}    resized\u000a         */\u000a        function attachResizeEvent(element, resized) {\u000a            if (!element) return;\u000a            if (element.resizedAttached) {\u000a                element.resizedAttached.add(resized);\u000a                return;\u000a            }\u000a\u000a            element.resizedAttached = new EventQueue();\u000a            element.resizedAttached.add(resized);\u000a\u000a            element.resizeSensor = document.createElement('div');\u000a            element.resizeSensor.dir = 'ltr';\u000a            element.resizeSensor.className = 'resize-sensor';\u000a            var style = 'position: absolute; left: -10px; top: -10px; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;';\u000a            var styleChild = 'position: absolute; left: 0; top: 0; transition: 0s;';\u000a\u000a            element.resizeSensor.style.cssText = style;\u000a            element.resizeSensor.innerHTML =\u000a                '<div class="resize-sensor-expand" style="' + style + '">' +\u000a                    '<div style="' + styleChild + '"></div>' +\u000a                '</div>' +\u000a                '<div class="resize-sensor-shrink" style="' + style + '">' +\u000a                    '<div style="' + styleChild + ' width: 200%; height: 200%"></div>' +\u000a                '</div>';\u000a            element.appendChild(element.resizeSensor);\u000a\u000a            var position = window.getComputedStyle(element).getPropertyPriority('position');\u000a            if ('absolute' !== position && 'relative' !== position && 'fixed' !== position) {\u000a                element.style.position = 'relative';\u000a            }\u000a\u000a            var expand = element.resizeSensor.childNodes[0];\u000a            var expandChild = expand.childNodes[0];\u000a            var shrink = element.resizeSensor.childNodes[1];\u000a            var dirty, rafId, newWidth, newHeight;\u000a            var size = getElementSize(element);\u000a            var lastWidth = size.width;\u000a            var lastHeight = size.height;\u000a\u000a            var reset = function() {\u000a                //set display to block, necessary otherwise hidden elements won't ever work\u000a                var invisible = element.offsetWidth === 0 && element.offsetHeight === 0;\u000a\u000a                if (invisible) {\u000a                    var saveDisplay = element.style.display;\u000a                    element.style.display = 'block';\u000a                }\u000a\u000a                expandChild.style.width = '100000px';\u000a                expandChild.style.height = '100000px';\u000a\u000a                expand.scrollLeft = 100000;\u000a                expand.scrollTop = 100000;\u000a\u000a                shrink.scrollLeft = 100000;\u000a                shrink.scrollTop = 100000;\u000a\u000a                if (invisible) {\u000a                    element.style.display = saveDisplay;\u000a                }\u000a            };\u000a            element.resizeSensor.resetSensor = reset;\u000a\u000a            var onResized = function() {\u000a                rafId = 0;\u000a\u000a                if (!dirty) return;\u000a\u000a                lastWidth = newWidth;\u000a                lastHeight = newHeight;\u000a\u000a                if (element.resizedAttached) {\u000a                    element.resizedAttached.call();\u000a                }\u000a            };\u000a\u000a            var onScroll = function() {\u000a                var size = getElementSize(element);\u000a                var newWidth = size.width;\u000a                var newHeight = size.height;\u000a                dirty = newWidth != lastWidth || newHeight != lastHeight;\u000a\u000a                if (dirty && !rafId) {\u000a                    rafId = requestAnimationFrame(onResized);\u000a                }\u000a\u000a                reset();\u000a            };\u000a\u000a            var addEvent = function(el, name, cb) {\u000a                if (el.attachEvent) {\u000a                    el.attachEvent('on' + name, cb);\u000a                } else {\u000a                    el.addEventListener(name, cb);\u000a                }\u000a            };\u000a\u000a            addEvent(expand, 'scroll', onScroll);\u000a            addEvent(shrink, 'scroll', onScroll);\u000a            \u000a			// Fix for custom Elements\u000a			requestAnimationFrame(reset);\u000a        }\u000a\u000a        forEachElement(element, function(elem){\u000a            attachResizeEvent(elem, callback);\u000a        });\u000a\u000a        this.detach = function(ev) {\u000a            ResizeSensor.detach(element, ev);\u000a        };\u000a\u000a        this.reset = function() {\u000a            element.resizeSensor.resetSensor();\u000a        };\u000a    };\u000a\u000a    ResizeSensor.reset = function(element, ev) {\u000a        forEachElement(element, function(elem){\u000a            elem.resizeSensor.resetSensor();\u000a        });\u000a    };\u000a\u000a    ResizeSensor.detach = function(element, ev) {\u000a        forEachElement(element, function(elem){\u000a            if (!elem) return;\u000a            if(elem.resizedAttached && typeof ev === "function"){\u000a                elem.resizedAttached.remove(ev);\u000a                if(elem.resizedAttached.length()) return;\u000a            }\u000a            if (elem.resizeSensor) {\u000a                if (elem.contains(elem.resizeSensor)) {\u000a                    elem.removeChild(elem.resizeSensor);\u000a                }\u000a                delete elem.resizeSensor;\u000a                delete elem.resizedAttached;\u000a            }\u000a        });\u000a    };\u000a\u000a    return ResizeSensor;\u000a\u000a}));\u000a\u000a;\u000a
p0
.